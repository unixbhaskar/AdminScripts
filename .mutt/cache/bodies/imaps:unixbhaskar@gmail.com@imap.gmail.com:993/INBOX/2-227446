Delivered-To: unixbhaskar@gmail.com
Received: by 2002:a19:41c8:0:0:0:0:0 with SMTP id o191csp2786841lfa;
        Mon, 9 Mar 2020 12:27:02 -0700 (PDT)
X-Google-Smtp-Source: ADFU+vskyShDZM1XIqxhomogUkSpEPTF99s2fy86tIbMVhQGhV9/fmeSo8rNXAPNrMOOOfh6KaU5
X-Received: by 2002:a9d:6a06:: with SMTP id g6mr13203408otn.305.1583782022654;
        Mon, 09 Mar 2020 12:27:02 -0700 (PDT)
ARC-Seal: i=1; a=rsa-sha256; t=1583782022; cv=none;
        d=google.com; s=arc-20160816;
        b=q/DJAqJ787UXePjdQVK5nQ4Hu+mQqe5Lllc5AxYunflBVdeTzELXmszfAtPu8VxQ3V
         PjoKNntlNT336BdZ/Uh0F+pujyE1nbpQs3lfauHmqG6fAPCC7RMiZxxgVvjps4UhyAcD
         sfixZrZe7rTMO7vRPN7FRFGDa2ltUf17M9BFRMsWFrwagRgrGuqSbrxFa5CthHw1VaEb
         MgRR3Doxv6iUDIsjesyI5YS8KD077DEQViNekw5tW/nC51Lc0k43TXj754cRbZk8QSZO
         6BCNQ5youAFa4q31rJ+b7Vpr4gvTzoRurG4/WSNkmPl2Oskl+f8ZNWam35wPgRAuGv2y
         JPQA==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;
        h=list-id:precedence:sender:thread-index:thread-topic
         :content-transfer-encoding:mime-version:subject:references
         :in-reply-to:message-id:cc:to:from:date:dkim-signature:dkim-filter;
        bh=70bU9x4pFcw4EitJgLR67S4Wwba/RzoCmlkulbS+k70=;
        b=Idx2kpDR/ft96bOZwfRv8IqfGYL1ggZcZL8DMvPnUC9uq9cHmyNx1cesq0DYlucCO1
         VsAeetz+kyM5ZZh/MyES+/LOU/HJYK0JuKzAwk058PJGJZzIFycPldBNuuraZ2uk4imM
         AE32yvDkvHV0eQxDf2ofkl+EgkXTzgY1nF0gknxndQUFyQwAlSghNKhhEJOliz1bRcG3
         pNyWLW8T4NDAWCccuvEwCtp4xW0gnDohziwek0DAeC7TKIvTUWwpxThaEu3UYyjJY81T
         inJ64M4oXPZKVETLjxIMyT+ehiB3F3eze8jYHNSfcLdENHcgkR+fZvrodCCPXQ7IvSJF
         +doA==
ARC-Authentication-Results: i=1; mx.google.com;
       dkim=pass header.i=@efficios.com header.s=default header.b=le8ftsl+;
       spf=pass (google.com: best guess record for domain of linux-kernel-owner@vger.kernel.org designates 209.132.180.67 as permitted sender) smtp.mailfrom=linux-kernel-owner@vger.kernel.org;
       dmarc=pass (p=NONE sp=NONE dis=NONE) header.from=efficios.com
Return-Path: <linux-kernel-owner@vger.kernel.org>
Received: from vger.kernel.org (vger.kernel.org. [209.132.180.67])
        by mx.google.com with ESMTP id e6si7036788oti.166.2020.03.09.12.26.53;
        Mon, 09 Mar 2020 12:27:02 -0700 (PDT)
Received-SPF: pass (google.com: best guess record for domain of linux-kernel-owner@vger.kernel.org designates 209.132.180.67 as permitted sender) client-ip=209.132.180.67;
Authentication-Results: mx.google.com;
       dkim=pass header.i=@efficios.com header.s=default header.b=le8ftsl+;
       spf=pass (google.com: best guess record for domain of linux-kernel-owner@vger.kernel.org designates 209.132.180.67 as permitted sender) smtp.mailfrom=linux-kernel-owner@vger.kernel.org;
       dmarc=pass (p=NONE sp=NONE dis=NONE) header.from=efficios.com
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1726492AbgCITZz (ORCPT <rfc822;ut0s.dev@gmail.com> + 69 others);
        Mon, 9 Mar 2020 15:25:55 -0400
Received: from mail.efficios.com ([167.114.26.124]:58454 "EHLO
        mail.efficios.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S1726295AbgCITZy (ORCPT
        <rfc822;linux-kernel@vger.kernel.org>);
        Mon, 9 Mar 2020 15:25:54 -0400
Received: from localhost (localhost [127.0.0.1])
        by mail.efficios.com (Postfix) with ESMTP id 1B380268C87;
        Mon,  9 Mar 2020 15:25:54 -0400 (EDT)
Received: from mail.efficios.com ([127.0.0.1])
        by localhost (mail03.efficios.com [127.0.0.1]) (amavisd-new, port 10032)
        with ESMTP id KnxvgsnLBXtE; Mon,  9 Mar 2020 15:25:53 -0400 (EDT)
Received: from localhost (localhost [127.0.0.1])
        by mail.efficios.com (Postfix) with ESMTP id D62F3268C86;
        Mon,  9 Mar 2020 15:25:53 -0400 (EDT)
DKIM-Filter: OpenDKIM Filter v2.10.3 mail.efficios.com D62F3268C86
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=efficios.com;
        s=default; t=1583781953;
        bh=70bU9x4pFcw4EitJgLR67S4Wwba/RzoCmlkulbS+k70=;
        h=Date:From:To:Message-ID:MIME-Version;
        b=le8ftsl+IzBrbyTQsXyfsvDSs/ACVk1v/NrLSE3i/cVEsBCpmT4zIcylFdX5TLRRT
         xkRsXEEbkNGgz09vLnNytZvfjVRQmVHAqjKXbjYFmDk7Rf70lkZG4A9ZGWoYXtZgCo
         cgV0/OoDYAr3aQgxxeYGhAorm+i3c+22gQ+VP50IvFRl1qakbne9gp2Vro9uD5+h84
         r3HnvHlvW7E5RYJg/PPT3lMKCvhfZmyD5PjR5tNBbhRI8yCr+6G73oQ3JlVL4tBleD
         6+1npY5Y8DZC/0W+EPYx0b8UOFJpAddskEnzlQ3WPYvKgUGSQmvv32qQY4jq8i4+aW
         HOelWCi3O0gAQ==
X-Virus-Scanned: amavisd-new at efficios.com
Received: from mail.efficios.com ([127.0.0.1])
        by localhost (mail03.efficios.com [127.0.0.1]) (amavisd-new, port 10026)
        with ESMTP id uGVwlSgowVas; Mon,  9 Mar 2020 15:25:53 -0400 (EDT)
Received: from mail03.efficios.com (mail03.efficios.com [167.114.26.124])
        by mail.efficios.com (Postfix) with ESMTP id C9797268A1C;
        Mon,  9 Mar 2020 15:25:53 -0400 (EDT)
Date:   Mon, 9 Mar 2020 15:25:53 -0400 (EDT)
From:   Mathieu Desnoyers <mathieu.desnoyers@efficios.com>
To:     rostedt <rostedt@goodmis.org>
Cc:     Thomas Gleixner <tglx@linutronix.de>,
        linux-kernel <linux-kernel@vger.kernel.org>,
        Peter Zijlstra <peterz@infradead.org>,
        Masami Hiramatsu <mhiramat@kernel.org>,
        Alexei Starovoitov <ast@kernel.org>,
        paulmck <paulmck@kernel.org>,
        "Joel Fernandes, Google" <joel@joelfernandes.org>,
        Frederic Weisbecker <frederic@kernel.org>
Message-ID: <1421454673.21890.1583781953778.JavaMail.zimbra@efficios.com>
In-Reply-To: <20200309150940.26730dee@gandalf.local.home>
References: <87mu8p797b.fsf@nanos.tec.linutronix.de> <1403546357.21810.1583779060302.JavaMail.zimbra@efficios.com> <20200309144427.0ce0eabc@gandalf.local.home> <1851876075.21840.1583779960064.JavaMail.zimbra@efficios.com> <20200309150940.26730dee@gandalf.local.home>
Subject: Re: Instrumentation and RCU
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Originating-IP: [167.114.26.124]
X-Mailer: Zimbra 8.8.15_GA_3901 (ZimbraWebClient - FF73 (Linux)/8.8.15_GA_3895)
Thread-Topic: Instrumentation and RCU
Thread-Index: i3rbokcdGHS5QSdW4VDvsuVnJMyLcQ==
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

----- On Mar 9, 2020, at 3:09 PM, rostedt rostedt@goodmis.org wrote:

> On Mon, 9 Mar 2020 14:52:40 -0400 (EDT)
> Mathieu Desnoyers <mathieu.desnoyers@efficios.com> wrote:
> 
>> And when I say "go back to plain RCU", I really mean removing use of SRCU
>> from the tracepoints until we have other purposes for it (e.g. taking
>> faults within specific tracepoint probes such as syscall enter/exit).
> 
> Actually, with both you and Alexei talking about having a sleeping
> tracepoint callback, where we can add a can sleep check (but not in the
> DO_TRACE macro, I would think that registered sleeping callbacks would be
> its own callback), I would think we do not want to remove the SRCU usage.

Whether we keep it or add it back later when needed should not make much
difference.

In any case, considering that overhead which motivated use of SRCU for the rcuidle
case could instead be handled by using is_rcu_watching() and normal RCU, I would
prefer removing it from the rcuidle tracepoints for now, and add it back when we
add a new kind of "sleepable" tracepoints later on.

Thanks,

Mathieu

-- 
Mathieu Desnoyers
EfficiOS Inc.
http://www.efficios.com
